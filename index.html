<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IGNATIUS' DATA HUBS</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Animate.css for animations -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <!-- Toastify for notifications -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <style>
        :root {
            --neon-green: #00ff00;
            --electric-green: #00ff88;
            --dark-green: #003300;
            --tech-black: #0a0a0a;
            --neon-cyan: #00ffff;
            --neon-purple: #ff00ff;
            --neon-yellow: #ffff00;
            --neon-blue: #0066ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: all 0.3s ease;
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #001a00 50%, #000a1a 100%);
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Custom Animations */
        @keyframes pulse-glow {
            0%, 100% { 
                box-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00, 0 0 15px #00ff00;
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00, 0 0 60px #00ff00;
                transform: scale(1.02);
            }
        }

        @keyframes pulse-cyan {
            0%, 100% { 
                box-shadow: 0 0 5px #00ffff, 0 0 10px #00ffff, 0 0 15px #00ffff;
            }
            50% { 
                box-shadow: 0 0 20px #00ffff, 0 0 40px #00ffff, 0 0 60px #00ffff;
            }
        }

        @keyframes pulse-purple {
            0%, 100% { 
                box-shadow: 0 0 5px #ff00ff, 0 0 10px #ff00ff, 0 0 15px #ff00ff;
            }
            50% { 
                box-shadow: 0 0 20px #ff00ff, 0 0 40px #ff00ff, 0 0 60px #ff00ff;
            }
        }

        @keyframes pulse-yellow {
            0%, 100% { 
                box-shadow: 0 0 5px #ffff00, 0 0 10px #ffff00, 0 0 15px #ffff00;
            }
            50% { 
                box-shadow: 0 0 20px #ffff00, 0 0 40px #ffff00, 0 0 60px #ffff00;
            }
        }

        @keyframes pulse-blue {
            0%, 100% { 
                box-shadow: 0 0 5px #0066ff, 0 0 10px #0066ff, 0 0 15px #0066ff;
            }
            50% { 
                box-shadow: 0 0 20px #0066ff, 0 0 40px #0066ff, 0 0 60px #0066ff;
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Custom Classes */
        .text-gradient {
            background: linear-gradient(45deg, #00ff88, #00ffff, #00ff00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .rainbow-glow {
            background: linear-gradient(45deg, #00ff00, #00ffff, #ff00ff, #ffff00, #00ff00);
            background-size: 400% 400%;
            animation: rainbow 3s linear infinite;
        }

        .neon-border {
            border: 1px solid rgba(0, 255, 0, 0.3);
            box-shadow: 
                0 0 10px rgba(0, 255, 0, 0.3),
                inset 0 0 10px rgba(0, 255, 0, 0.1);
        }

        .card-glow {
            box-shadow: 
                0 0 20px rgba(0, 255, 0, 0.1),
                0 0 40px rgba(0, 255, 0, 0.05),
                inset 0 0 20px rgba(0, 255, 0, 0.05);
        }

        .animate-pulse-glow {
            animation: pulse-glow 2s infinite;
        }

        .animate-pulse-cyan {
            animation: pulse-cyan 3s infinite;
        }

        .animate-pulse-purple {
            animation: pulse-purple 3s infinite;
        }

        .animate-pulse-yellow {
            animation: pulse-yellow 3s infinite;
        }

        .animate-pulse-blue {
            animation: pulse-blue 3s infinite;
        }

        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        .glow-effect {
            position: relative;
            overflow: hidden;
        }

        .glow-effect::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to right, rgba(0, 255, 0, 0) 0%, rgba(0, 255, 136, 0.2) 50%, rgba(0, 255, 0, 0) 100%);
            filter: blur(10px);
            animation: shimmer 3s infinite;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #003300;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #00ff88, #00ff00);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #00ffff, #00ff88);
        }

        /* Selection Color */
        ::selection {
            background: #00ff88;
            color: #000;
        }

        /* Grid Background */
        .grid-bg {
            background-image: 
                linear-gradient(to right, rgba(0, 255, 0, 0.05) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(0, 255, 0, 0.05) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 255, 0, 0.1);
            border-left-color: #00ff00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .status-pending {
            background: #fff4e6;
            color: #f90;
        }
        
        .status-completed {
            background: #e6f7ee;
            color: #006400;
        }
        
        .status-failed {
            background: #ffe6e6;
            color: #e00;
        }

        .buy-btn {
            @apply w-full py-4 bg-gradient-to-r from-[#00ffff] to-[#00ff88] text-black font-bold rounded-xl text-lg flex items-center justify-center gap-3 hover:shadow-2xl transition-all duration-300;
        }
        
        .buy-btn-sm {
            @apply mt-2 px-4 py-2 bg-gradient-to-r from-[#ffff00] to-orange-500 text-black font-bold rounded-lg text-sm flex items-center gap-2 hover:shadow-lg transition-all duration-300;
        }

        /* Add animation for newly added elements */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.5s ease-out;
        }
    </style>
</head>
<body class="relative">
    <!-- Animated Background -->
    <canvas id="backgroundCanvas" class="fixed inset-0 pointer-events-none z-0"></canvas>

    <!-- 1. Hero Section -->
    <section id="hero" class="min-h-screen relative flex items-center pt-20 px-4">
        <div class="container mx-auto max-w-6xl relative z-10">
            <div class="text-center">
                <h1 class="text-5xl md:text-7xl font-bold mb-4 text-gradient animate__animated animate__fadeInDown">
                    IGNATIUS' DATA HUBS
                </h1>
                <p class="text-2xl md:text-4xl mb-8 text-[#00ff88] animate__animated animate__fadeInUp animate__delay-1s">
                    PATA DATA HATA UKIWA NA OKOA
                </p>
                <p class="text-xl mb-10 text-gray-300 max-w-3xl mx-auto animate__animated animate__fadeIn animate__delay-2s">
                    Instant data, minutes & SMS deals. Pay securely via M-Pesa STK Push API and get activated in seconds!
                </p>
                
                <button onclick="scrollToDeals()" 
                    class="px-10 py-5 bg-gradient-to-r from-[#00ff88] via-[#00ffff] to-[#00ff00] text-black font-bold rounded-xl text-xl shadow-2xl hover:shadow-[#00ff00]/50 transition-all duration-300 animate-pulse-glow glow-effect">
                    <i class="fas fa-bolt mr-3"></i>
                    BUY NOW WITH M-PESA
                </button>
            </div>
        </div>
    </section>

    <!-- 2. Deals Section -->
    <section id="deals" class="py-20 relative px-4">
        <div class="container mx-auto max-w-6xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-6xl font-bold mb-6 text-gradient animate__animated animate__fadeIn">ðŸ”¥ HOT DEALS</h2>
                <p class="text-gray-400 text-xl">Choose from our exclusive bundles - Pay securely via M-Pesa API</p>
            </div>

            <!-- Category Filter -->
            <div class="flex flex-wrap justify-center gap-4 mb-12">
                <button onclick="filterDeals('all')" 
                    class="category-btn active px-8 py-3 rounded-full font-bold flex items-center gap-3 rainbow-glow text-black">
                    <i class="fas fa-fire"></i>
                    All Deals
                </button>
                <button onclick="filterDeals('data')" 
                    class="category-btn px-8 py-3 rounded-full font-bold flex items-center gap-3 neon-border text-gray-300 hover:bg-[#003300]">
                    <i class="fas fa-database"></i>
                    Data Bundles
                </button>
                <button onclick="filterDeals('minutes')" 
                    class="category-btn px-8 py-3 rounded-full font-bold flex items-center gap-3 neon-border text-gray-300 hover:bg-[#003300]">
                    <i class="fas fa-hourglass-half"></i>
                    Minutes
                </button>
                <button onclick="filterDeals('sms')" 
                    class="category-btn px-8 py-3 rounded-full font-bold flex items-center gap-3 neon-border text-gray-300 hover:bg-[#003300]">
                    <i class="fas fa-comment-alt"></i>
                    SMS
                </button>
            </div>

            <!-- 2.1 Bingwa Data Deals -->
            <div class="mb-16 animate__animated animate__fadeInUp">
                <div class="flex items-center gap-4 mb-8">
                    <i class="fas fa-crown text-4xl text-[#ffff00]"></i>
                    <h3 class="text-3xl md:text-4xl font-bold text-gradient">BINGWA DATA DEALS</h3>
                    <span class="text-sm bg-[#ffff00] text-black px-3 py-1 rounded-full font-bold">Buy Many Times</span>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                    <!-- Bingwa Deal Cards -->
                    <div class="deal-card" data-category="data" data-type="Bingwa">
                        <div class="relative bg-gradient-to-b from-[#0a0a0a] to-[#003300]/80 backdrop-blur-sm rounded-3xl p-8 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-500 animate-pulse-cyan">
                            <div class="flex justify-between items-start mb-6">
                                <div class="flex items-center gap-3">
                                    <i class="fas fa-database text-2xl text-[#00ffff]"></i>
                                    <span class="text-xs font-bold px-3 py-1.5 rounded-full bg-gradient-to-r from-[#00ffff] to-[#00ff88] text-black">
                                        BINGWA
                                    </span>
                                </div>
                                <i class="fas fa-crown text-2xl text-[#ffff00]"></i>
                            </div>

                            <h3 class="text-2xl font-bold mb-4 text-white">250MBs</h3>
                            
                            <div class="mb-8">
                                <div class="flex items-baseline gap-3 mb-3">
                                    <span class="text-4xl font-bold text-gradient">KES 20</span>
                                    <div class="text-sm bg-[#00ff00]/10 text-[#00ff00] px-2 py-1 rounded">
                                        24 Hours
                                    </div>
                                </div>
                                <div class="flex items-center gap-3 text-gray-400">
                                    <i class="fas fa-star text-[#ffff00]"></i>
                                    <span>Instant Activation</span>
                                </div>
                            </div>

                            <button onclick="selectDeal('250MBs Bingwa', 20)" 
                                class="w-full py-4 bg-gradient-to-r from-[#00ffff] to-[#00ff88] text-black font-bold rounded-xl text-lg flex items-center justify-center gap-3 hover:shadow-2xl transition-all duration-300">
                                <i class="fas fa-bolt"></i>
                                BUY NOW
                            </button>
                        </div>
                    </div>

                    <!-- Repeat similar structure for other Bingwa deals -->
                    <div class="deal-card" data-category="data" data-type="Bingwa">
                        <div class="relative bg-gradient-to-b from-[#0a0a0a] to-[#003300]/80 backdrop-blur-sm rounded-3xl p-8 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-500 animate-pulse-cyan">
                            <!-- ... same structure ... -->
                            <h3 class="text-2xl font-bold mb-4 text-white">1GB</h3>
                            <span class="text-4xl font-bold text-gradient">KES 19</span>
                            <div class="text-sm bg-[#00ff00]/10 text-[#00ff00] px-2 py-1 rounded">1 Hour</div>
                            <button onclick="selectDeal('1GB Bingwa', 19)" class="buy-btn">BUY NOW</button>
                        </div>
                    </div>

                    <div class="deal-card" data-category="data" data-type="Bingwa">
                        <div class="relative bg-gradient-to-b from-[#0a0a0a] to-[#003300]/80 backdrop-blur-sm rounded-3xl p-8 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-500 animate-pulse-cyan">
                            <h3 class="text-2xl font-bold mb-4 text-white">1.5GB</h3>
                            <span class="text-4xl font-bold text-gradient">KES 49</span>
                            <div class="text-sm bg-[#00ff00]/10 text-[#00ff00] px-2 py-1 rounded">3 Hours</div>
                            <button onclick="selectDeal('1.5GB Bingwa', 49)" class="buy-btn">BUY NOW</button>
                        </div>
                    </div>

                    <div class="deal-card" data-category="data" data-type="Bingwa">
                        <div class="relative bg-gradient-to-b from-[#0a0a0a] to-[#003300]/80 backdrop-blur-sm rounded-3xl p-8 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-500 animate-pulse-cyan">
                            <h3 class="text-2xl font-bold mb-4 text-white">350MBs</h3>
                            <span class="text-4xl font-bold text-gradient">KES 50</span>
                            <div class="text-sm bg-[#00ff00]/10 text-[#00ff00] px-2 py-1 rounded">7 Days</div>
                            <button onclick="selectDeal('350MBs Bingwa', 50)" class="buy-btn">BUY NOW</button>
                        </div>
                    </div>

                    <div class="deal-card" data-category="data" data-type="Bingwa">
                        <div class="relative bg-gradient-to-b from-[#0a0a0a] to-[#003300]/80 backdrop-blur-sm rounded-3xl p-8 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-500 animate-pulse-cyan">
                            <h3 class="text-2xl font-bold mb-4 text-white">2.5GB</h3>
                            <span class="text-4xl font-bold text-gradient">KES 300</span>
                            <div class="text-sm bg-[#00ff00]/10 text-[#00ff00] px-2 py-1 rounded">7 Days</div>
                            <button onclick="selectDeal('2.5GB Bingwa', 300)" class="buy-btn">BUY NOW</button>
                        </div>
                    </div>

                    <div class="deal-card" data-category="data" data-type="Bingwa">
                        <div class="relative bg-gradient-to-b from-[#0a0a0a] to-[#003300]/80 backdrop-blur-sm rounded-3xl p-8 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-500 animate-pulse-cyan">
                            <h3 class="text-2xl font-bold mb-4 text-white">6GB</h3>
                            <span class="text-4xl font-bold text-gradient">KES 700</span>
                            <div class="text-sm bg-[#00ff00]/10 text-[#00ff00] px-2 py-1 rounded">7 Days</div>
                            <button onclick="selectDeal('6GB Bingwa', 700)" class="buy-btn">BUY NOW</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 2.2 Minutes Deals -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <div class="animate__animated animate__fadeInLeft">
                    <div class="flex items-center gap-4 mb-8">
                        <i class="fas fa-hourglass-half text-3xl text-[#ffff00]"></i>
                        <h3 class="text-3xl font-bold text-gradient">MINUTES DEALS</h3>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <span class="text-sm bg-[#00ff88] text-black px-2 py-1 rounded mr-2">Buy Once in a Day</span>
                                <span class="text-sm bg-[#ffff00] text-black px-2 py-1 rounded">Buy Many Times</span>
                            </div>
                        </div>

                        <!-- Minutes Deal Cards -->
                        <div class="deal-card compact" data-category="minutes" data-type="Minutes">
                            <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-yellow">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <i class="fas fa-hourglass-half text-2xl text-[#ffff00]"></i>
                                        <div>
                                            <div class="flex items-center gap-2">
                                                <h3 class="text-xl font-bold text-white">45 Mins</h3>
                                                <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#ffff00] to-orange-500 text-black">
                                                    MINUTES
                                                </span>
                                            </div>
                                            <p class="text-gray-400 text-sm">3 Hours</p>
                                        </div>
                                    </div>
                                    
                                    <div class="text-right">
                                        <div class="text-2xl font-bold text-gradient">KES 23</div>
                                        <button onclick="selectDeal('45 Mins', 23)" 
                                            class="mt-2 px-4 py-2 bg-gradient-to-r from-[#ffff00] to-orange-500 text-black font-bold rounded-lg text-sm flex items-center gap-2 hover:shadow-lg transition-all duration-300">
                                            <i class="fas fa-bolt"></i>
                                            BUY
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- More minutes deals -->
                        <div class="deal-card compact" data-category="minutes" data-type="Minutes">
                            <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-yellow">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <i class="fas fa-hourglass-half text-2xl text-[#ffff00]"></i>
                                        <div>
                                            <div class="flex items-center gap-2">
                                                <h3 class="text-xl font-bold text-white">50 Mins</h3>
                                                <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#ffff00] to-orange-500 text-black">
                                                    MINUTES
                                                </span>
                                            </div>
                                            <p class="text-gray-400 text-sm">Till Midnight</p>
                                        </div>
                                    </div>
                                    
                                    <div class="text-right">
                                        <div class="text-2xl font-bold text-gradient">KES 51</div>
                                        <button onclick="selectDeal('50 Mins', 51)" class="buy-btn-sm">BUY</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="deal-card compact" data-category="data" data-type="Minutes Special">
                            <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-yellow">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <i class="fas fa-database text-2xl text-[#00ffff]"></i>
                                        <div>
                                            <div class="flex items-center gap-2">
                                                <h3 class="text-xl font-bold text-white">1.25GB</h3>
                                                <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#ffff00] to-orange-500 text-black">
                                                    SPECIAL
                                                </span>
                                            </div>
                                            <p class="text-gray-400 text-sm">Till Midnight</p>
                                        </div>
                                    </div>
                                    
                                    <div class="text-right">
                                        <div class="text-2xl font-bold text-gradient">KES 55</div>
                                        <button onclick="selectDeal('1.25GB Special', 55)" class="buy-btn-sm">BUY</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2.3 SMS & Tunukiwa Deals -->
                <div class="space-y-12">
                    <!-- SMS Deals -->
                    <div class="animate__animated animate__fadeInRight">
                        <div class="flex items-center gap-4 mb-8">
                            <i class="fas fa-comment-alt text-3xl text-[#ff00ff]"></i>
                            <h3 class="text-3xl font-bold text-gradient">SMS DEALS</h3>
                            <span class="text-sm bg-[#ffff00] text-black px-3 py-1 rounded-full font-bold">Buy Many Times</span>
                        </div>
                        
                        <div class="space-y-4">
                            <!-- SMS Deal Cards -->
                            <div class="deal-card compact" data-category="sms" data-type="SMS">
                                <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-purple">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-comment-alt text-2xl text-[#ff00ff]"></i>
                                            <div>
                                                <div class="flex items-center gap-2">
                                                    <h3 class="text-xl font-bold text-white">20 SMS</h3>
                                                    <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#ff00ff] to-pink-500 text-black">
                                                        SMS
                                                    </span>
                                                </div>
                                                <p class="text-gray-400 text-sm">1 Day</p>
                                            </div>
                                        </div>
                                        
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-gradient">KES 5</div>
                                            <button onclick="selectDeal('20 SMS', 5)" class="buy-btn-sm">BUY</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- More SMS deals -->
                            <div class="deal-card compact" data-category="sms" data-type="SMS">
                                <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-purple">
                                    <!-- Similar structure for 100 SMS (KES 10) -->
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-comment-alt text-2xl text-[#ff00ff]"></i>
                                            <div>
                                                <div class="flex items-center gap-2">
                                                    <h3 class="text-xl font-bold text-white">100 SMS</h3>
                                                    <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#ff00ff] to-pink-500 text-black">
                                                        SMS
                                                    </span>
                                                </div>
                                                <p class="text-gray-400 text-sm">7 Days</p>
                                            </div>
                                        </div>
                                        
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-gradient">KES 10</div>
                                            <button onclick="selectDeal('100 SMS', 10)" class="buy-btn-sm">BUY</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="deal-card compact" data-category="sms" data-type="SMS">
                                <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-purple">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-comment-alt text-2xl text-[#ff00ff]"></i>
                                            <div>
                                                <div class="flex items-center gap-2">
                                                    <h3 class="text-xl font-bold text-white">300 SMS</h3>
                                                    <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#ff00ff] to-pink-500 text-black">
                                                        SMS
                                                    </span>
                                                </div>
                                                <p class="text-gray-400 text-sm">7 Days</p>
                                            </div>
                                        </div>
                                        
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-gradient">KES 30</div>
                                            <button onclick="selectDeal('300 SMS', 30)" class="buy-btn-sm">BUY</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="deal-card compact" data-category="sms" data-type="SMS">
                                <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-purple">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-comment-alt text-2xl text-[#ff00ff]"></i>
                                            <div>
                                                <div class="flex items-center gap-2">
                                                    <h3 class="text-xl font-bold text-white">1500 SMS</h3>
                                                    <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#ff00ff] to-pink-500 text-black">
                                                        SMS
                                                    </span>
                                                </div>
                                                <p class="text-gray-400 text-sm">30 Days</p>
                                            </div>
                                        </div>
                                        
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-gradient">KES 101</div>
                                            <button onclick="selectDeal('1500 SMS', 101)" class="buy-btn-sm">BUY</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 2.4 Tunukiwa Deals -->
                    <div class="animate__animated animate__fadeInRight animate__delay-1s">
                        <div class="flex items-center gap-4 mb-8">
                            <i class="fas fa-database text-3xl text-[#00ffff]"></i>
                            <h3 class="text-3xl font-bold text-gradient">TUNUKIWA DEALS</h3>
                            <span class="text-sm bg-[#ffff00] text-black px-3 py-1 rounded-full font-bold">Buy Many Times</span>
                        </div>
                        
                        <div class="space-y-4">
                            <!-- Tunukiwa Deal Cards -->
                            <div class="deal-card compact" data-category="data" data-type="Tunukiwa">
                                <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-cyan">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-database text-2xl text-[#00ffff]"></i>
                                            <div>
                                                <div class="flex items-center gap-2">
                                                    <h3 class="text-xl font-bold text-white">1GB</h3>
                                                    <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#00ff00] to-[#00ff88] text-black">
                                                        TUNUKIWA
                                                    </span>
                                                </div>
                                                <p class="text-gray-400 text-sm">1 Hour</p>
                                            </div>
                                        </div>
                                        
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-gradient">KES 22</div>
                                            <button onclick="selectDeal('1GB Tunukiwa', 22)" class="buy-btn-sm">BUY</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- More Tunukiwa deals -->
                            <div class="deal-card compact" data-category="data" data-type="Tunukiwa">
                                <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-cyan">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-database text-2xl text-[#00ffff]"></i>
                                            <div>
                                                <div class="flex items-center gap-2">
                                                    <h3 class="text-xl font-bold text-white">1.5GB</h3>
                                                    <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#00ff00] to-[#00ff88] text-black">
                                                        TUNUKIWA
                                                    </span>
                                                </div>
                                                <p class="text-gray-400 text-sm">3 Hours</p>
                                            </div>
                                        </div>
                                        
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-gradient">KES 52</div>
                                            <button onclick="selectDeal('1.5GB Tunukiwa', 52)" class="buy-btn-sm">BUY</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="deal-card compact" data-category="data" data-type="Tunukiwa">
                                <div class="relative bg-gradient-to-b from-[#0a0a0a]/90 to-[#003300]/90 backdrop-blur-sm rounded-2xl p-6 border-2 border-[#00ff00]/20 hover:border-[#00ff00]/50 transition-all duration-300 animate-pulse-cyan">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <i class="fas fa-database text-2xl text-[#00ffff]"></i>
                                            <div>
                                                <div class="flex items-center gap-2">
                                                    <h3 class="text-xl font-bold text-white">2GB</h3>
                                                    <span class="text-xs font-bold px-2 py-1 rounded-full bg-gradient-to-r from-[#00ff00] to-[#00ff88] text-black">
                                                        TUNUKIWA
                                                    </span>
                                                </div>
                                                <p class="text-gray-400 text-sm">24 Hours</p>
                                            </div>
                                        </div>
                                        
                                        <div class="text-right">
                                            <div class="text-2xl font-bold text-gradient">KES 110</div>
                                            <button onclick="selectDeal('2GB Tunukiwa', 110)" class="buy-btn-sm">BUY</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 3. M-Pesa API Payment Section -->
    <section id="payment" class="py-20 bg-[#003300]/30 relative px-4">
        <div class="container mx-auto max-w-6xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold mb-4 text-gradient">ðŸ“± M-PESA API PAYMENT</h2>
                <p class="text-gray-400 text-xl">Secure payment via M-Pesa STK Push</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                <!-- Steps -->
                <div class="space-y-6 animate__animated animate__fadeInLeft">
                    <div class="bg-[#0a0a0a]/80 backdrop-blur-sm rounded-2xl p-8 neon-border">
                        <h3 class="text-2xl font-bold mb-6 text-[#00ff88]">How It Works:</h3>
                        <ol class="space-y-6">
                            <li class="flex items-center gap-4 text-lg">
                                <span class="w-10 h-10 bg-gradient-to-br from-[#00ff88] to-[#00ff00] rounded-full flex items-center justify-center text-black font-bold">1</span>
                                <span class="text-gray-300">Select a deal from above</span>
                            </li>
                            <li class="flex items-center gap-4 text-lg">
                                <span class="w-10 h-10 bg-gradient-to-br from-[#00ff88] to-[#00ff00] rounded-full flex items-center justify-center text-black font-bold">2</span>
                                <span class="text-gray-300">Enter your M-Pesa number</span>
                            </li>
                            <li class="flex items-center gap-4 text-lg">
                                <span class="w-10 h-10 bg-gradient-to-br from-[#00ff88] to-[#00ff00] rounded-full flex items-center justify-center text-black font-bold">3</span>
                                <span class="text-gray-300">Click "Pay Now" button</span>
                            </li>
                            <li class="flex items-center gap-4 text-lg">
                                <span class="w-10 h-10 bg-gradient-to-br from-[#00ff88] to-[#00ff00] rounded-full flex items-center justify-center text-black font-bold">4</span>
                                <span class="text-gray-300">Check your phone for STK Push</span>
                            </li>
                            <li class="flex items-center gap-4 text-lg">
                                <span class="w-10 h-10 bg-gradient-to-br from-[#00ff88] to-[#00ff00] rounded-full flex items-center justify-center text-black font-bold">5</span>
                                <span class="text-gray-300">Enter your M-Pesa PIN</span>
                            </li>
                            <li class="flex items-center gap-4 text-lg">
                                <span class="w-10 h-10 bg-gradient-to-br from-[#00ff88] to-[#00ff00] rounded-full flex items-center justify-center text-black font-bold">6</span>
                                <span class="text-gray-300">Receive confirmation & bundle</span>
                            </li>
                        </ol>
                    </div>
                </div>

                <!-- Payment Form -->
                <div class="bg-[#0a0a0a]/90 backdrop-blur-sm rounded-2xl p-8 neon-border rainbow-glow animate__animated animate__fadeInRight">
                    <div class="text-center mb-8">
                        <h3 class="text-2xl font-bold mb-2 text-gradient">MAKE PAYMENT</h3>
                        <p class="text-gray-400">All payments processed via secure M-Pesa API</p>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <label class="block text-gray-300 mb-3 text-lg">Selected Deal</label>
                            <div id="selectedDealDisplay" class="w-full px-6 py-4 bg-black/50 border-2 border-[#00ff00]/30 rounded-xl text-white text-lg">
                                No deal selected
                            </div>
                        </div>

                        <div>
                            <label class="block text-gray-300 mb-3 text-lg">Phone Number (254...)</label>
                            <input type="tel" id="phoneNumber" 
                                class="w-full px-6 py-4 bg-black/50 border-2 border-[#00ff00]/30 rounded-xl focus:outline-none focus:ring-4 focus:ring-[#00ff00]/50 text-white text-lg"
                                placeholder="2547XXXXXXXX" value="2547">
                        </div>

                        <div>
                            <label class="block text-gray-300 mb-3 text-lg">Amount (KES)</label>
                            <input type="number" id="amount" 
                                class="w-full px-6 py-4 bg-black/50 border-2 border-[#00ff00]/30 rounded-xl focus:outline-none focus:ring-4 focus:ring-[#00ff00]/50 text-white text-lg"
                                placeholder="Enter amount from selected deal">
                        </div>

                        <button id="initiateBtn" onclick="initiatePayment()" 
                            class="w-full py-5 bg-gradient-to-r from-[#00ff88] via-[#00ffff] to-[#00ff00] text-black font-bold rounded-xl text-xl flex items-center justify-center gap-4 hover:shadow-2xl hover:shadow-[#00ff00]/50 transition-all duration-300 animate-pulse-glow disabled:opacity-50 disabled:cursor-not-allowed">
                            <i class="fab fa-mpesa text-2xl"></i>
                            <span id="initiateBtnText">PAY NOW</span>
                        </button>

                        <!-- Transaction Status Section -->
                        <div class="transaction-section hidden" id="transactionSection">
                            <h3 class="text-xl font-bold mb-4 text-[#00ff88]">Transaction Status</h3>
                            <div class="transaction-details bg-black/40 rounded-xl p-4">
                                <div class="detail-row flex justify-between mb-2">
                                    <span class="text-gray-400">Checkout Request ID:</span>
                                    <span id="checkoutId" class="text-white font-mono">-</span>
                                </div>
                                <div class="detail-row flex justify-between">
                                    <span class="text-gray-400">Status:</span>
                                    <span class="status-badge status-pending" id="statusBadge">Pending</span>
                                </div>
                            </div>

                            <div class="mt-6">
                                <label class="block text-gray-300 mb-3 text-lg">Checkout Request ID</label>
                                <input type="text" id="checkoutRequestId" 
                                    class="w-full px-6 py-4 bg-black/50 border-2 border-[#00ff00]/30 rounded-xl text-white text-lg mb-4"
                                    placeholder="Paste Checkout Request ID here">
                                
                                <button id="verifyBtn" onclick="verifyTransaction()" 
                                    class="w-full py-3 bg-gradient-to-r from-[#ffff00] to-orange-500 text-black font-bold rounded-xl flex items-center justify-center gap-3 hover:shadow-lg transition-all duration-300">
                                    <i class="fas fa-search"></i>
                                    Verify Transaction
                                </button>
                            </div>
                        </div>

                        <!-- Response Box -->
                        <div class="response-box bg-black/40 rounded-xl p-4 mt-4 hidden" id="responseBox">
                            <div class="flex justify-between items-center mb-2">
                                <span class="text-gray-300">API Response:</span>
                                <button onclick="document.getElementById('responseBox').classList.add('hidden')" class="text-gray-400 hover:text-white">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <pre id="responseContent" class="text-sm text-gray-300 overflow-auto max-h-40">Response will appear here...</pre>
                        </div>

                        <div class="mt-6 p-6 bg-black/40 rounded-xl">
                            <div class="flex items-center gap-4 text-lg text-gray-300">
                                <i class="fas fa-shield-alt text-[#00ff88] text-2xl animate-pulse"></i>
                                <div>
                                    <div class="font-bold">100% Secure Payment</div>
                                    <div class="text-sm text-gray-400">â€¢ Instant Activation â€¢ 24/7 Support â€¢ M-Pesa Secured</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 4. Help & Contact Section -->
    <section id="contact" class="py-20 relative px-4">
        <div class="container mx-auto max-w-4xl">
            <div class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-bold mb-6 text-gradient">ðŸ†˜ HELP & SUPPORT</h2>
                <p class="text-gray-400 text-xl">We're here to help you 24/7</p>
            </div>

            <!-- Safaricom Help Line -->
            <div class="mb-16 animate__animated animate__fadeInUp">
                <div class="bg-gradient-to-r from-[#003300] to-[#0a0a0a] rounded-2xl p-8 neon-border">
                    <h3 class="text-2xl font-bold mb-4 text-[#00ff88]">Safaricom Help Line</h3>
                    <div class="flex items-center justify-center gap-6">
                        <i class="fas fa-phone text-4xl text-[#00ff88] animate-pulse"></i>
                        <div>
                            <div class="text-4xl md:text-5xl font-bold text-white rainbow-glow p-3 rounded-xl">
                                0119100218
                            </div>
                            <p class="text-gray-400 mt-2">For M-Pesa or network issues</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Options -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-16">
                <a href="tel:0119100218" 
                    class="flex items-center gap-6 px-8 py-6 bg-[#003300] rounded-2xl hover:bg-[#00ff88]/10 transition-all duration-300 neon-border animate-pulse-cyan">
                    <div class="relative">
                        <i class="fas fa-phone text-[#00ff88] text-4xl"></i>
                        <div class="absolute -top-1 -right-1 w-4 h-4 bg-[#00ff00] rounded-full animate-ping"></div>
                    </div>
                    <div class="text-left">
                        <div class="text-gray-400 text-sm">Call for Support</div>
                        <div class="text-2xl font-bold text-white">Contact Us</div>
                        <div class="text-[#00ff88] text-sm mt-1">Immediate assistance</div>
                    </div>
                </a>

                <a href="https://wa.me/254741234567" target="_blank"
                    class="flex items-center gap-6 px-8 py-6 bg-[#003300] rounded-2xl hover:bg-[#25D366]/10 transition-all duration-300 border border-[#25D366]/30 animate-pulse">
                    <i class="fab fa-whatsapp text-[#25D366] text-4xl"></i>
                    <div class="text-left">
                        <div class="text-gray-400 text-sm">WhatsApp Support</div>
                        <div class="text-2xl font-bold text-white">Chat Now</div>
                        <div class="text-[#25D366] text-sm mt-1">Quick responses</div>
                    </div>
                </a>
            </div>

            <!-- Payment Guarantee -->
            <div class="bg-[#0a0a0a]/50 rounded-2xl p-8 neon-border">
                <h3 class="text-3xl font-bold mb-8 text-gradient">âœ… PAYMENT GUARANTEE</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="text-center p-6">
                        <div class="text-5xl mb-4">âš¡</div>
                        <h4 class="font-bold text-xl mb-3 text-white">Instant Activation</h4>
                        <p class="text-gray-400">Get your bundle within seconds</p>
                    </div>
                    <div class="text-center p-6">
                        <div class="text-5xl mb-4">ðŸ”’</div>
                        <h4 class="font-bold text-xl mb-3 text-white">Secure Payments</h4>
                        <p class="text-gray-400">100% secure M-Pesa API transactions</p>
                    </div>
                    <div class="text-center p-6">
                        <div class="text-5xl mb-4">ðŸ”„</div>
                        <h4 class="font-bold text-xl mb-3 text-white">Money Back</h4>
                        <p class="text-gray-400">Full refund if activation fails</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 5. Footer -->
    <footer class="py-12 bg-[#0a0a0a] border-t border-[#00ff00]/20">
        <div class="container mx-auto px-4 text-center">
            <div class="text-2xl font-bold text-gradient mb-4">IGNATIUS' DATA HUBS</div>
            <div class="text-gray-400 mb-2">PATA DATA HATA UKIWA NA OKOA</div>
            <div class="text-gray-400 mb-6">All payments processed via secure M-Pesa API</div>
            <div class="text-sm text-gray-500">
                Â© <span id="currentYear"></span> Ignatius' Data Hubs. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- 6. Floating Buttons -->
    <button onclick="scrollToDeals()" 
        class="fixed bottom-6 right-6 z-40 w-16 h-16 bg-gradient-to-br from-[#00ff88] via-[#00ffff] to-[#00ff00] rounded-full flex items-center justify-center shadow-2xl shadow-[#00ff00]/50 animate-pulse-glow">
        <i class="fas fa-bolt text-black text-2xl"></i>
    </button>

    <a href="https://wa.me/254741234567" target="_blank"
        class="fixed bottom-32 right-6 z-40 w-14 h-14 bg-[#25D366] rounded-full flex items-center justify-center shadow-2xl">
        <i class="fab fa-whatsapp text-white text-2xl"></i>
    </a>

    <!-- Scroll to Top Button -->
    <button id="scrollTopButton" onclick="scrollToTop()" 
        class="fixed bottom-24 right-6 z-40 w-12 h-12 bg-gradient-to-br from-[#00ff88] to-[#00ff00] rounded-full flex items-center justify-center shadow-2xl shadow-[#00ff00]/50 animate-pulse-glow hidden">
        <i class="fas fa-arrow-up text-black"></i>
    </button>

    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    
    <!-- Main JavaScript Code -->
    <script>
        // 1. Initialize variables
        const API_BASE_URL = "https://mpesapi.giftedtech.co.ke";
        let selectedDeal = null;
        let selectedPrice = 0;
        let currentTransaction = {
            checkoutRequestId: null,
            transactionId: null
        };
        let pollInterval = null;

        // 2. Wait for DOM to load
        document.addEventListener('DOMContentLoaded', function() {
            // Set current year in footer
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Initialize animated background
            initBackground();
            
            // Initialize scroll button visibility
            initScrollButton();
            
            // Initialize deal filtering
            initDealFiltering();
            
            // Initialize form validation
            initFormValidation();
        });

        // 3. Animated Background
        function initBackground() {
            const canvas = document.getElementById('backgroundCanvas');
            const ctx = canvas.getContext('2d');
            let particles = [];

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                initParticles();
            }

            function initParticles() {
                particles = [];
                const particleCount = Math.min(100, Math.floor((canvas.width * canvas.height) / 10000));
                
                for (let i = 0; i < particleCount; i++) {
                    particles.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        size: Math.random() * 2 + 1,
                        speedX: Math.random() * 0.5 - 0.25,
                        speedY: Math.random() * 0.5 - 0.25,
                        color: getRandomColor(),
                        opacity: Math.random() * 0.3 + 0.1,
                        waveOffset: Math.random() * Math.PI * 2
                    });
                }
            }

            function getRandomColor() {
                const colors = [
                    { r: 0, g: 255, b: 0 },
                    { r: 0, g: 255, b: 136 },
                    { r: 0, g: 255, b: 255 },
                    { r: 255, g: 0, b: 255 },
                    { r: 255, g: 255, b: 0 },
                ];
                return colors[Math.floor(Math.random() * colors.length)];
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw grid
                drawGrid();
                
                // Update and draw particles
                particles.forEach(particle => {
                    particle.waveOffset += 0.02;
                    particle.x += particle.speedX + Math.sin(particle.waveOffset) * 0.3;
                    particle.y += particle.speedY + Math.cos(particle.waveOffset) * 0.3;

                    // Bounce off edges
                    if (particle.x > canvas.width) particle.x = 0;
                    else if (particle.x < 0) particle.x = canvas.width;
                    if (particle.y > canvas.height) particle.y = 0;
                    else if (particle.y < 0) particle.y = canvas.height;

                    // Draw particle
                    ctx.beginPath();
                    ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${particle.color.r}, ${particle.color.g}, ${particle.color.b}, ${particle.opacity})`;
                    ctx.fill();
                });

                // Connect particles
                for (let i = 0; i < particles.length; i++) {
                    for (let j = i + 1; j < particles.length; j++) {
                        const dx = particles[i].x - particles[j].x;
                        const dy = particles[i].y - particles[j].y;
                        const distance = Math.sqrt(dx * dx + dy * dy);

                        if (distance < 120) {
                            const opacity = 0.1 * (1 - distance / 120);
                            ctx.beginPath();
                            ctx.strokeStyle = `rgba(${particles[i].color.r}, ${particles[i].color.g}, ${particles[i].color.b}, ${opacity})`;
                            ctx.lineWidth = 0.5;
                            ctx.moveTo(particles[i].x, particles[i].y);
                            ctx.lineTo(particles[j].x, particles[j].y);
                            ctx.stroke();
                        }
                    }
                }

                requestAnimationFrame(animate);
            }

            function drawGrid() {
                ctx.strokeStyle = 'rgba(0, 255, 0, 0.03)';
                ctx.lineWidth = 1;
                
                // Vertical lines
                for (let x = 0; x < canvas.width; x += 60) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, canvas.height);
                    ctx.stroke();
                }
                
                // Horizontal lines
                for (let y = 0; y < canvas.height; y += 60) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }
            }

            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
            animate();
        }

        // 4. Scroll to Top Functionality
        function initScrollButton() {
            window.addEventListener('scroll', function() {
                const scrollButton = document.getElementById('scrollTopButton');
                if (window.scrollY > 500) {
                    scrollButton.classList.remove('hidden');
                } else {
                    scrollButton.classList.add('hidden');
                }
            });
        }

        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function scrollToDeals() {
            document.getElementById('deals').scrollIntoView({ behavior: 'smooth' });
        }

        // 5. Deal Selection and Filtering
        function initDealFiltering() {
            // Add active class to first category button
            document.querySelectorAll('.category-btn')[0].classList.add('rainbow-glow', 'text-black');
        }

        function filterDeals(category) {
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('rainbow-glow', 'text-black');
                btn.classList.add('neon-border', 'text-gray-300');
            });
            
            event.target.classList.add('rainbow-glow', 'text-black');
            event.target.classList.remove('neon-border', 'text-gray-300');

            // Filter deals
            const allDeals = document.querySelectorAll('.deal-card');
            allDeals.forEach(deal => {
                if (category === 'all' || deal.getAttribute('data-category') === category) {
                    deal.style.display = 'block';
                    deal.classList.add('animate__animated', 'animate__fadeIn');
                } else {
                    deal.style.display = 'none';
                }
            });
        }

        function selectDeal(dealName, price) {
            selectedDeal = dealName;
            selectedPrice = price;
            
            // Update payment form
            document.getElementById('selectedDealDisplay').textContent = `${dealName} - KES ${price}`;
            document.getElementById('amount').value = price;
            
            // Show success message
            showToast(`Selected: ${dealName} - KES ${price}`, 'success');
            
            // Scroll to payment section
            document.getElementById('payment').scrollIntoView({ behavior: 'smooth' });
        }

        // 6. Form Validation
        function initFormValidation() {
            const phoneInputs = document.querySelectorAll('input[type="tel"]');
            phoneInputs.forEach(input => {
                input.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');
                    if (!value.startsWith('254')) {
                        if (value.startsWith('7')) {
                            value = '254' + value;
                        } else if (value.startsWith('0')) {
                            value = '254' + value.substring(1);
                        }
                    }
                    if (value.length > 12) {
                        value = value.substring(0, 12);
                    }
                    e.target.value = value;
                });
            });
        }

        function validatePhoneNumber(phone) {
            const cleanPhone = phone.replace(/\D/g, '');
            if (!cleanPhone) return false;
            
            // Check if it's a valid Safaricom number (starts with 2547 and 12 digits)
            if (!/^2547\d{8}$/.test(cleanPhone)) {
                return false;
            }
            
            return true;
        }

        // 7. Toast Notifications
        function showToast(message, type = 'info', duration = 5000) {
            Toastify({
                text: message,
                duration: duration,
                gravity: "top",
                position: "right",
                backgroundColor: type === 'success' ? "rgba(0, 255, 0, 0.9)" : 
                               type === 'error' ? "rgba(255, 0, 0, 0.9)" : 
                               type === 'warning' ? "rgba(255, 165, 0, 0.9)" :
                               "rgba(0, 0, 0, 0.9)",
                stopOnFocus: true,
                className: "neon-border",
                escapeMarkup: false
            }).showToast();
        }

        // 8. API Payment Functions
        async function initiatePayment() {
            const phone = document.getElementById('phoneNumber').value;
            const amount = document.getElementById('amount').value;
            
            if (!validatePhoneNumber(phone)) {
                showToast('Please enter a valid Safaricom number (2547XXXXXXXX)', 'error');
                return;
            }
            
            if (!amount || amount <= 0) {
                showToast('Please select a deal first', 'error');
                return;
            }
            
            const initiateBtn = document.getElementById('initiateBtn');
            const initiateBtnText = document.getElementById('initiateBtnText');
            
            initiateBtn.disabled = true;
            initiateBtnText.innerHTML = '<div class="spinner" style="width: 20px; height: 20px;"></div> Initiating...';
            
            try {
                showToast('Initiating M-Pesa payment request...', 'info');
                
                const response = await fetch(`${API_BASE_URL}/api/payNexusTech.php`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        phoneNumber: phone,
                        amount: amount
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    showToast('STK Push sent successfully! Check your phone', 'success');
                    
                    currentTransaction.checkoutRequestId = data.CheckoutRequestID;
                    
                    // Update UI
                    document.getElementById('checkoutId').textContent = data.CheckoutRequestID;
                    document.getElementById('checkoutRequestId').value = data.CheckoutRequestID;
                    document.getElementById('transactionSection').classList.remove('hidden');
                    document.getElementById('responseBox').classList.remove('hidden');
                    document.getElementById('responseContent').textContent = JSON.stringify(data, null, 2);
                    
                    // Start polling for transaction status
                    pollTransactionStatus(data.CheckoutRequestID);
                } else {
                    showToast('Failed to send STK Push: ' + (data.error || 'Unknown error'), 'error');
                    document.getElementById('responseBox').classList.remove('hidden');
                    document.getElementById('responseContent').textContent = JSON.stringify(data, null, 2);
                }
            } catch (error) {
                console.error('Error initiating payment:', error);
                showToast('Error initiating payment: ' + error.message, 'error');
            } finally {
                initiateBtn.disabled = false;
                initiateBtnText.textContent = 'PAY NOW';
            }
        }
        
        async function verifyTransaction() {
            const checkoutRequestId = document.getElementById('checkoutRequestId').value;
            
            if (!checkoutRequestId) {
                showToast('Please enter a Checkout Request ID', 'error');
                return;
            }
            
            const verifyBtn = document.getElementById('verifyBtn');
            const originalText = verifyBtn.innerHTML;
            
            verifyBtn.disabled = true;
            verifyBtn.innerHTML = '<div class="spinner" style="width: 20px; height: 20px;"></div> Verifying...';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/verify-transaction.php`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        checkoutRequestId: checkoutRequestId
                    })
                });
                
                const data = await response.json();
                
                const statusBadge = document.getElementById('statusBadge');
                statusBadge.textContent = data.status.charAt(0).toUpperCase() + data.status.slice(1);
                statusBadge.className = 'status-badge status-' + data.status;
                
                document.getElementById('responseBox').classList.remove('hidden');
                document.getElementById('responseContent').textContent = JSON.stringify(data, null, 2);
                
                if (data.success) {
                    showToast('Transaction verified successfully!', 'success');
                } else if (data.status === 'pending') {
                    showToast('Transaction is still pending', 'warning');
                } else {
                    showToast('Transaction failed: ' + (data.data?.ResultDesc || 'Unknown reason'), 'error');
                }
            } catch (error) {
                console.error('Error verifying transaction:', error);
                showToast('Error verifying transaction: ' + error.message, 'error');
                document.getElementById('responseContent').textContent = 'Error: ' + error.message;
            } finally {
                verifyBtn.disabled = false;
                verifyBtn.innerHTML = originalText;
            }
        }
        
        async function pollTransactionStatus(checkoutRequestId) {
            let attempts = 0;
            const maxAttempts = 30; // Try for 5 minutes (30 attempts * 10 seconds)
            
            if (pollInterval) clearInterval(pollInterval);
            
            pollInterval = setInterval(async () => {
                if (attempts >= maxAttempts) {
                    clearInterval(pollInterval);
                    showToast('Transaction status polling timed out', 'error');
                    return;
                }
                
                attempts++;
                
                try {
                    const response = await fetch(`${API_BASE_URL}/api/verify-transaction.php`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            checkoutRequestId: checkoutRequestId
                        })
                    });
                    
                    const data = await response.json();
                    
                    const statusBadge = document.getElementById('statusBadge');
                    statusBadge.textContent = data.status.charAt(0).toUpperCase() + data.status.slice(1);
                    statusBadge.className = 'status-badge status-' + data.status;
                    
                    document.getElementById('responseContent').textContent = JSON.stringify(data, null, 2);
                    
                    if (data.status === 'completed' || data.status === 'failed') {
                        clearInterval(pollInterval);
                        
                        if (data.status === 'completed') {
                            showToast('Payment completed successfully! Bundle activated.', 'success');
                        } else {
                            showToast('Payment failed: ' + (data.data?.ResultDesc || 'Unknown reason'), 'error');
                        }
                    }
                } catch (error) {
                    console.error('Error polling transaction status:', error);
                }
            }, 10000); // Poll every 10 seconds
        }

        // 9. Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Enter to submit form
            if (e.key === 'Enter' && !document.getElementById('initiateBtn').disabled) {
                initiatePayment();
            }
        });

        // Initialize phone number with default
        document.getElementById('phoneNumber').value = '2547';
    </script>
</body>
</html>
